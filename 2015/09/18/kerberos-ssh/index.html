
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>使用 Kerberos 作为 SSH 服务的认证协议 | 飛哥の技术博客</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="李飛">
    

    
    <meta name="description" content="我们常见的 SSH 认证方式有用户名密码认证，公钥/私钥认证等，这些认证比较适合个人使用，但如果管辖的机器过多，就会出现调整认证的不方便的情况。譬如：如果现在有 100 台服务器，由于业务需要（如：基于 ansible 的部署系统），这些机器需要做到对特定账号免登。假设我们采用公钥私钥的认证方式实现免登需求，需要在每台免登机器中都要放置一个公钥。突然有一天私钥泄漏了，必须要把这 100 台机器的认">
<meta property="og:type" content="article">
<meta property="og:title" content="使用 Kerberos 作为 SSH 服务的认证协议">
<meta property="og:url" content="http://lifei.github.io/2015/09/18/kerberos-ssh/index.html">
<meta property="og:site_name" content="飛哥の技术博客">
<meta property="og:description" content="我们常见的 SSH 认证方式有用户名密码认证，公钥/私钥认证等，这些认证比较适合个人使用，但如果管辖的机器过多，就会出现调整认证的不方便的情况。譬如：如果现在有 100 台服务器，由于业务需要（如：基于 ansible 的部署系统），这些机器需要做到对特定账号免登。假设我们采用公钥私钥的认证方式实现免登需求，需要在每台免登机器中都要放置一个公钥。突然有一天私钥泄漏了，必须要把这 100 台机器的认">
<meta property="og:image" content="http://www.plantuml.com/plantuml/svg/NSen3iCW30NGdLDOxBb0LLK2Ce5w222MWbHC5Shz2yGJqxVV_rGE1Dlo5tm5AsYy3g-0Lwc3t4toxUEP2479eMfHFLKlQgQQHVUfkn0Mjkq52XxWgQRmGHRDQJZxLDr5dyQISwCK_IyLOZUSS_ZiX_i3">
<meta property="og:updated_time" content="2016-01-24T19:19:50.314Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="使用 Kerberos 作为 SSH 服务的认证协议">
<meta name="twitter:description" content="我们常见的 SSH 认证方式有用户名密码认证，公钥/私钥认证等，这些认证比较适合个人使用，但如果管辖的机器过多，就会出现调整认证的不方便的情况。譬如：如果现在有 100 台服务器，由于业务需要（如：基于 ansible 的部署系统），这些机器需要做到对特定账号免登。假设我们采用公钥私钥的认证方式实现免登需求，需要在每台免登机器中都要放置一个公钥。突然有一天私钥泄漏了，必须要把这 100 台机器的认">

    
    <link rel="alternative" href="/atom.xml" title="飛哥の技术博客" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.jpg" alt="飛哥の技术博客" title="飛哥の技术博客"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="飛哥の技术博客">飛哥の技术博客</a></h1>
				<h2 class="blog-motto">关注业务开发</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">首页</a></li>
					
						<li><a href="/archives">归档</a></li>
					
						<li><a href="/about">关于</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:lifei.github.io">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/09/18/kerberos-ssh/" title="使用 Kerberos 作为 SSH 服务的认证协议" itemprop="url">使用 Kerberos 作为 SSH 服务的认证协议</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="李飛" target="_blank" itemprop="author">李飛</a>
		
  <p class="article-time">
    <time datetime="2015-09-18T06:32:00.000Z" itemprop="datePublished"> 发表于 2015-09-18</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		
			<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#__"><span class="toc-number">1.</span> <span class="toc-text">背景</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#__kerberos"><span class="toc-number">1.1.</span> <span class="toc-text">什么是 Kerberos？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#___2"><span class="toc-number">1.2.</span> <span class="toc-text">面临的问题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#___3"><span class="toc-number">2.</span> <span class="toc-text">目标</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#___4"><span class="toc-number">3.</span> <span class="toc-text">方案架构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#_sshd"><span class="toc-number">4.</span> <span class="toc-text">SSHD配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#_ssh_server_client_kerberos"><span class="toc-number">5.</span> <span class="toc-text">ssh server/client上Kerberos配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#_krb5_conf"><span class="toc-number">5.1.</span> <span class="toc-text">krb5.conf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#__principal"><span class="toc-number">5.2.</span> <span class="toc-text">添加principal</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#__principal_key"><span class="toc-number">5.3.</span> <span class="toc-text">导出principal key</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#__k5login"><span class="toc-number">5.4.</span> <span class="toc-text">在服务端配置.k5login文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#_kerberos"><span class="toc-number">6.</span> <span class="toc-text">Kerberos服务器配置调整</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#_trouble_shooting"><span class="toc-number">7.</span> <span class="toc-text">Trouble shooting</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#__kdc_has_no_support_for_encryption_type"><span class="toc-number">7.1.</span> <span class="toc-text">『KDC has no support for encryption type』</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#__wrong_principal_in_request_debug1_got_no_client_credentials"><span class="toc-number">7.2.</span> <span class="toc-text">『Wrong principal in request/debug1: Got no client credentials』</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#__no_key_table_entry_found_matching_xxxxxx"><span class="toc-number">7.3.</span> <span class="toc-text">『No key table entry found matching xxxxxx』</span></a></li></ol></li></ol>
		
		</div>
		
		<div class="sect1">
<h2 id="__">背景</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="__kerberos">什么是 Kerberos？</h3>
<div class="paragraph">
<p>Kerberos 这一名词来源于希腊神话『三个头的狗--地狱之门守护者』系统设计上采用客户端/服务器结构与 DES 加密技术，并且能够进行相互认证，即客户端和服务器端均可对对方进行身份认证。可以用于防止窃听、防止 replay 攻击、保护数据完整性等场合，是一种应用对称密钥体制进行密钥管理的系统。</p>
</div>
<div class="paragraph">
<p>Kerberos 是一种网络认证协议，其设计目标是通过密钥系统为客户机/服务器应用程序提供强大的认证服务。该认证过程的实现不依赖于主机操作系统的认证，无需基于主机地址的信任，不要求网络上所有主机的物理安全，并假定网络上传送的数据包可以被任意地读取、修改和插入数据。在以上情况下， Kerberos 作为一种可信任的第三方认证服务，是通过传统的密码技术（如：共享密钥）执行认证服务的。</p>
</div>
<div class="paragraph">
<p>使用 Kerberos 时，一个客户端需要经过三个步骤来获取服务:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>认证：客户端向认证服务器发送一条报文，并获取一个含时间戳的 Ticket-Granting Ticket（TGT）。</p>
</li>
<li>
<p>授权：客户端使用 TGT 向 Ticket-Granting Server（TGS）请求一个服务 Ticket。</p>
</li>
<li>
<p>服务请求：客户端向服务器出示服务 Ticket，以证实自己的合法性。该服务器提供客户端所需服务，在 Hadoop 应用中，服务器可以是 namenode 或 jobtracker。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>为此，Kerberos 需要『The Key Distribution Centers（KDC）』来进行认证。KDC 只有一个 Master，可以带多个 Slaves Slaves 机器仅进行普通验证。Master 上做的修改需要自动同步到 Slaves。</p>
</div>
<div class="paragraph">
<p>另外，KDC 需要一个 admin 来进行日常的管理操作，即 kadmin。kadmin 可以通过远程或者本地方式登录。</p>
</div>
</div>
<div class="sect2">
<h3 id="___2">面临的问题</h3>
<div class="paragraph">
<p>我们常见的 SSH 认证方式有用户名密码认证，公钥/私钥认证等，这些认证比较适合个人使用，但如果管辖的机器过多，就会出现调整认证的不方便的情况。譬如：如果现在有 100 台服务器，由于业务需要（如：基于 ansible 的部署系统），这些机器需要做到对特定账号免登。假设我们采用公钥私钥的认证方式实现免登需求，需要在每台免登机器中都要放置一个公钥。突然有一天私钥泄漏了，必须要把这 100 台机器的认证都调整一遍，也就是说要把 100 台机器上的公钥都更换成新的公钥，肯定不是一件容易的事情。而假如我们采取了第三方集中认证授权的方式（如：Kerberos），那只需要在 Kerberos 服务端重置一下 KEY 即可。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="___3">目标</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>实现各个服务器之间的免登；</p>
</li>
<li>
<p>认证泄漏后，调整成本最小；</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="___4">方案架构</h2>
<div class="sectionbody">
<div class="paragraph">
<p>根据实际情况和安全需要，本方案设计双层认证的机制：</p>
</div>
<div class="olist arabic">
<div class="title">双层认证方案</div>
<ol class="arabic">
<li>
<p>开设 ansible 账号，为每台机器设置 ansible 账号的认证权限；</p>
</li>
<li>
<p>ansible 的认证仅在跳板机上进行；</p>
</li>
<li>
<p>开设 communication 账号，为每台机器设置 communication 账号的认证权限；</p>
</li>
<li>
<p>communication 的认证会在每一台服务器上进行，由 ansible 进行。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">安全措施</div>
<ol class="arabic">
<li>
<p>如果 ansible 认证泄漏，仅需要在 Kerberos 服务器上重置 ansible 账号的 KEY，在跳板机重新对 ansible 账号进行认证即可。</p>
</li>
<li>
<p>如果 communication 认证泄漏，需在 Kerberos 服务器上重置 communication 账号的 KEY，同时通过 ansible 账号对每台机器的 communication 账号进行认证。</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">架构图</div>
<div class="content">
<pre><img src="http://www.plantuml.com/plantuml/svg/NSen3iCW30NGdLDOxBb0LLK2Ce5w222MWbHC5Shz2yGJqxVV_rGE1Dlo5tm5AsYy3g-0Lwc3t4toxUEP2479eMfHFLKlQgQQHVUfkn0Mjkq52XxWgQRmGHRDQJZxLDr5dyQISwCK_IyLOZUSS_ZiX_i3"></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sshd">SSHD配置</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="title">sshd_config</div>
<div class="content">
<pre>ChallengeResponseAuthentication no

KerberosAuthentication no
KerberosOrLocalPasswd no
KerberosTicketCleanup no

GSSAPIAuthentication yes
GSSAPICleanupCredentials yes
GSSAPIStrictAcceptorCheck no
GSSAPIKeyExchange no

UsePAM yes</pre>
</div>
</div>
<div class="listingblock">
<div class="title">整体参考</div>
<div class="content">
<pre>Protocol 2
SyslogFacility AUTHPRIV
LogLevel INFO
PermitRoot no
PasswordAuthentication yes
ChallengeResponseAuthentication no
GSSAPIAuthentication yes
GSSAPICleanupCredentials yes
UsePAM yes
AcceptEnv LANG LC_CTYPE LC_NUMERIC LC_TIME LC_COLLATE LC_MONETARY LC_MESSAGES
AcceptEnv LC_PAPER LC_NAME LC_ADDRESS LC_TELEPHONE LC_MEASUREMENT
AcceptEnv LC_IDENTIFICATION LC_ALL LANGUAGE
AcceptEnv XMODIFIERS
X11Forwarding yes
Subsystem       sftp    /usr/libexec/openssh/sftp-server</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ssh_server_client_kerberos">ssh server/client上Kerberos配置</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_krb5_conf">krb5.conf</h3>
<div class="listingblock">
<div class="title">krb5.conf</div>
<div class="content">
<pre>[logging]
 default = FILE:/var/log/krb5libs.log

[libdefaults]
 default_realm = 7V1.NET
 dns_lookup_realm = false
 dns_lookup_kdc = false
 ticket_lifetime = 24h
 renew_lifetime = 7d
 forwardable = true

[realms]
 7V1.NET = &#123;
  kdc = 172.17.0.35
  admin_server = 172.17.0.35
  default_domain = 7v1.net
 &#125;

[domain_realm]
 .7v1.net = 7V1.NET
 7v1.net = 7V1.NET</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
这里使用7v1.net作为例子。
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="__principal">添加principal</h3>
<div class="paragraph">
<p>在<code>Kerberos</code>中注册本机</p>
</div>
<div class="listingblock">
<div class="title">server</div>
<div class="content">
<pre>kadmin -q "ank -randkey host/ssh.7v1.net"</pre>
</div>
</div>
<div class="listingblock">
<div class="title">client</div>
<div class="content">
<pre>kadmin -q "ank -randkey host/client.7v1.net"</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="__principal_key">导出principal key</h3>
<div class="paragraph">
<p>把本机的key的添加到keytab中</p>
</div>
<div class="listingblock">
<div class="title">server</div>
<div class="content">
<pre>kadmin -q "ktadd host/ssh.7v1.net"</pre>
</div>
</div>
<div class="listingblock">
<div class="title">client</div>
<div class="content">
<pre>kadmin -q "ank -randkey host/client.7v1.net"</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="__k5login">在服务端配置.k5login文件</h3>
<div class="listingblock">
<div class="title">.k5login</div>
<div class="content">
<pre>username@7V1.NET</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_kerberos">Kerberos服务器配置调整</h2>
<div class="sectionbody">
<div class="paragraph">
<p>由于<code>Kerberos</code>版本升级兼容问题<sup class="footnote" id="_footnote_note2">[<a id="_footnoteref_1" class="footnote" href="#_footnote_1" title="View footnote.">1</a>]</sup>，
krb5 1.7及以后版本禁用了<code>DES encryption key</code>，会导致错误
<code>credential verification failed: KDC has no support for encryption type</code>，
请参考下面解决</p>
</div>
<div class="literalblock">
<div class="content">
<pre>This most commonly happens when trying to use a principal with only DES keys, in a release (MIT krb5 1.7 or later) which disables DES by default. DES encryption is considered weak due to its inadequate key size. If you cannot migrate away from its use, you can re-enable DES by adding allow_weak_crypto = true to the [libdefaults] section of krb5.conf.</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_trouble_shooting">Trouble shooting</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="__kdc_has_no_support_for_encryption_type">『KDC has no support for encryption type』</h3>
<div class="paragraph">
<p>krb5 1.7及以后版本禁用了<code>DES encryption key</code>所致。</p>
</div>
</div>
<div class="sect2">
<h3 id="__wrong_principal_in_request_debug1_got_no_client_credentials">『Wrong principal in request/debug1: Got no client credentials』</h3>
<div class="paragraph">
<p>服务器没有配置 .k5login</p>
</div>
</div>
<div class="sect2">
<h3 id="__no_key_table_entry_found_matching_xxxxxx">『No key table entry found matching xxxxxx』</h3>
<div class="paragraph">
<p>服务端没有把导出key到keytab</p>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnote_1">
<a href="#_footnoteref_1">1</a>. http://web.mit.edu/kerberos/krb5-devel/doc/admin/troubleshoot.html
</div>
</div>  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/Kerberos/">Kerberos</a><a href="/tags/SSH/">SSH</a><a href="/tags/授权/">授权</a><a href="/tags/运维/">运维</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://lifei.github.io/2015/09/18/kerberos-ssh/" data-title="使用 Kerberos 作为 SSH 服务的认证协议 | 飛哥の技术博客" data-tsina="null" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2015/12/20/webpack/" title="基于 Webpack 的前端资源构建方案">
  <strong>上一篇：</strong><br/>
  <span>
  基于 Webpack 的前端资源构建方案</span>
</a>
</div>


<div class="next">
<a href="/2015/08/27/programming-proverbs/"  title="每个程序员都应该熟知的编程格言">
 <strong>下一篇：</strong><br/> 
 <span>每个程序员都应该熟知的编程格言
</span>
</a>
</div>

</nav>

	
<section id="comments" class="comment">
	<div class="ds-thread" data-thread-key="2015/09/18/kerberos-ssh/" data-title="使用 Kerberos 作为 SSH 服务的认证协议" data-url="http://lifei.github.io/2015/09/18/kerberos-ssh/"></div>
</section>


</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
 
 <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#__"><span class="toc-number">1.</span> <span class="toc-text">背景</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#__kerberos"><span class="toc-number">1.1.</span> <span class="toc-text">什么是 Kerberos？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#___2"><span class="toc-number">1.2.</span> <span class="toc-text">面临的问题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#___3"><span class="toc-number">2.</span> <span class="toc-text">目标</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#___4"><span class="toc-number">3.</span> <span class="toc-text">方案架构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#_sshd"><span class="toc-number">4.</span> <span class="toc-text">SSHD配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#_ssh_server_client_kerberos"><span class="toc-number">5.</span> <span class="toc-text">ssh server/client上Kerberos配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#_krb5_conf"><span class="toc-number">5.1.</span> <span class="toc-text">krb5.conf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#__principal"><span class="toc-number">5.2.</span> <span class="toc-text">添加principal</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#__principal_key"><span class="toc-number">5.3.</span> <span class="toc-text">导出principal key</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#__k5login"><span class="toc-number">5.4.</span> <span class="toc-text">在服务端配置.k5login文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#_kerberos"><span class="toc-number">6.</span> <span class="toc-text">Kerberos服务器配置调整</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#_trouble_shooting"><span class="toc-number">7.</span> <span class="toc-text">Trouble shooting</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#__kdc_has_no_support_for_encryption_type"><span class="toc-number">7.1.</span> <span class="toc-text">『KDC has no support for encryption type』</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#__wrong_principal_in_request_debug1_got_no_client_credentials"><span class="toc-number">7.2.</span> <span class="toc-text">『Wrong principal in request/debug1: Got no client credentials』</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#__no_key_table_entry_found_matching_xxxxxx"><span class="toc-number">7.3.</span> <span class="toc-text">『No key table entry found matching xxxxxx』</span></a></li></ol></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
		
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/Kerberos/" title="Kerberos">Kerberos<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Webpack/" title="Webpack">Webpack<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Docker/" title="Docker">Docker<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/SASL/" title="SASL">SASL<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/OpenLDAP/" title="OpenLDAP">OpenLDAP<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Git/" title="Git">Git<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/SSH/" title="SSH">SSH<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/运维/" title="运维">运维<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/授权/" title="授权">授权<sup>1</sup></a></li>
			
		
			
		
			
		
			
		
			
		
			
		
			
		
			
		
			
		
		</ul>
</div>


  
  <div class="archiveslist">
    <p class="asidetitle"><a href="/archives">归档</a></p>
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">十二月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">九月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">八月 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">七月 2015</a><span class="archive-list-count">2</span></li></ul>
  </div>


  
  <div class="tagcloudlist">
    <p class="asidetitle">标签云</p>
    <div class="tagcloudlist clearfix">
       <a href="/tags/Docker/" style="font-size: 10px;">Docker</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/Kerberos/" style="font-size: 20px;">Kerberos</a> <a href="/tags/OpenLDAP/" style="font-size: 10px;">OpenLDAP</a> <a href="/tags/SASL/" style="font-size: 10px;">SASL</a> <a href="/tags/SSH/" style="font-size: 10px;">SSH</a> <a href="/tags/Webpack/" style="font-size: 10px;">Webpack</a> <a href="/tags/授权/" style="font-size: 10px;">授权</a> <a href="/tags/运维/" style="font-size: 10px;">运维</a>
    </div>
  </div>


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> 大家好，我是李飛。 <br/>
			这是我的博客。</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		
		<a href="https://github.com/lifei" target="_blank" class="icon-github" title="github"></a>
		
		
		
		
		
		
		
		
		
		<a href="mailto:lifei.vip@outlook.com" target="_blank" class="icon-email" title="Email Me"></a>
		
	</div>
			
		
				<div class="cc-license">
          <a href="http://creativecommons.org/licenses/by-nc-nd/4.0" class="cc-opacity" target="_blank">
            <img src="/img/cc-by-nc-nd.svg" alt="Creative Commons" />
          </a>
        </div>
    

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2016 
		
		<a href="/about" target="_blank" title="李飛">李飛</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>



<script type="text/javascript">
  var duoshuoQuery = {short_name:"lifei"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 







<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->



<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F418d4490462c5561efb0c541ad93c308' type='text/javascript'%3E%3C/script%3E"));
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
